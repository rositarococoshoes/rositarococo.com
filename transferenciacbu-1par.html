<!DOCTYPE html>
<html>
<head>
<!-- Google Tag Manager REMOVIDO - Ahora usando Facebook Pixel directo -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>&iquest;C&oacute;mo comprar?</title>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link href="https://stefano.brilli.me/google-forms-html-exporter/styles/vendor.css" rel="stylesheet" />
	<link href="https://stefano.brilli.me/google-forms-html-exporter/styles/main.css" rel="stylesheet" />
	<style type="text/css">img {max-width:100%;}
      form {max-width:400px;     padding: 0px 5px;}
      button, html input[type=button], input[type=reset], input[type=submit] {margin-bottom: 10px; font-size: 20px; width: 100%;}
    .checkbox label, .radio label {padding-left:0px;}
    .checkbox-inline input[type=checkbox], .checkbox input[type=checkbox], .radio-inline input[type=radio], .radio input[type=radio] { margin-left: 0px; width: 30px; height: 30px; margin: 5px 280px;}
      input[type="checkbox"]:checked { box-shadow: 0 0 0 5px yellow;}
      input[type="checkbox"]:checked+img { box-shadow: 0 0 0 5px yellow;}
     ::placeholder { /* Chrome, Firefox, Opera, Safari 10.1+ */
  color: #777;
  opacity: 1; /* Firefox */
}

:-ms-input-placeholder { /* Internet Explorer 10-11 */
  color: #777;
}

::-ms-input-placeholder { /* Microsoft Edge */
  color: #777;
}

.myButton {
    -moz-box-shadow: inset 0px 1px 0px 0px #54a3f7;
    -webkit-box-shadow: inset 0px 1px 0px 0px #54a3f7;
    box-shadow: inset 0px 1px 0px 0px #54a3f7;
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0.05, #007dc1), color-stop(1, #0061a7));
    background: -moz-linear-gradient(top, #007dc1 5%, #0061a7 100%);
    background: -webkit-linear-gradient(top, #007dc1 5%, #0061a7 100%);
    background: -o-linear-gradient(top, #007dc1 5%, #0061a7 100%);
    background: -ms-linear-gradient(top, #007dc1 5%, #0061a7 100%);
    background: linear-gradient(to bottom, #007dc1 5%, #0061a7 100%);
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#007dc1', endColorstr='#0061a7',GradientType=0);
    background-color: #3483fa;
    -moz-border-radius: 3px;
    -webkit-border-radius: 3px;
    border-radius: 3px;
    border: #3483fa;
    display: inline-block;
    cursor: pointer;
    color: #ffffff;
    font-family: Arial;
    text-align: center;
    font-size: 20px;
    width: 100%;
    padding: 5px 24px;
    text-decoration: none;
    text-shadow: 0px 1px 0px #3483fa;
}
.myButton:hover {
	background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #0061a7), color-stop(1, #007dc1));
	background:-moz-linear-gradient(top, #0061a7 5%, #007dc1 100%);
	background:-webkit-linear-gradient(top, #0061a7 5%, #007dc1 100%);
	background:-o-linear-gradient(top, #0061a7 5%, #007dc1 100%);
	background:-ms-linear-gradient(top, #0061a7 5%, #007dc1 100%);
	background:linear-gradient(to bottom, #0061a7 5%, #007dc1 100%);
	filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#0061a7', endColorstr='#007dc1',GradientType=0);
	background-color:#0061a7;
}
.myButton:active {
	position:relative;
	top:1px;
}
	</style>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js" integrity="sha256-2Pjr1OlpZMY6qesJM68t2v39t+lMLvxwpa8QlRjJroA=" crossorigin="anonymous"></script>
</head>
<body style="cursor: auto;background-color:white;">
<!-- GTM noscript removido - Ahora usando Facebook Pixel directo -->
<div style="max-width: 400px; padding: 0px 5px;">
<p><img alt="" src="rosita-form.png" /></p>


<h4 style="text-align: center;"><strong><span style="font-size:22px;"><span style="background-color:#FFFF00;">PAG&Aacute; TU PEDIDO AHORA</span></span></strong></h4>

<div style="padding:10px; background-color: lightyellow; margin: auto;border:1px solid lightgrey;"><span id="talleselegidos"></span></div>

<p style="margin-top:20px;"><span style="color:#000000;"><span style="font-size:14px;"><u><strong>Transferencia Bancaria:</strong></u></span></span></p>

<p>Banco Santander<br>
  Número de CBU: 0720570588000035387718<br>
  Alias de CBU: RROCOCO.S<br>
  Titular de la cuenta: Baustian Roxana<br>
</p>

<p style="margin-top: 35px;">Pag&aacute; y mandanos una foto del ticket de pago.</p>

<p>Pag&aacute; <strong>$63.000</strong> por 1 par. El env&iacute;o es GRATIS en todos los casos.</p>

<p>Luego de pagar mandanos&nbsp;foto del ticket de pago <a href="http://bit.ly/wspb-rosita">por Whatsapp tocando aqu&iacute; &gt;</a></p>

<p>Sin la foto del comprobante de transferencia de pago tu pedido NO se procesa.</p>

<p>&iexcl;Gracias! Aguardamos tu PAGO y tu AVISO por Whatsapp para despachar!!<br />
Whatsapp aqu&iacute; =&gt; <a href="http://bit.ly/wspb-rosita" style="background-color: rgb(252, 252, 252);">http://bit.ly/wspb-rosita</a></p>

</div>
<script>
// Get order details from sessionStorage instead of URL parameters
var talleselegidos = sessionStorage.getItem('orderDetails') || '';
$("#talleselegidos").replaceWith(talleselegidos);

// If no data in sessionStorage, try legacy URL parameter method as fallback
if (!talleselegidos) {
    var getUrlParameter = function getUrlParameter(sParam) {
        var sPageURL = window.location.search.substring(1),
            sURLVariables = sPageURL.split('&'),
            sParameterName,
            i;

        for (i = 0; i < sURLVariables.length; i++) {
            sParameterName = sURLVariables[i].split('=');

            if (sParameterName[0] === sParam) {
                return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
            }
        }
    };

    talleselegidos = getUrlParameter('entry.1471599855') || '';
    $("#talleselegidos").replaceWith(talleselegidos);
}

// Display customer name if available
var customerName = sessionStorage.getItem('customerName');
if (customerName) {
    var greetingElement = document.createElement('p');
    greetingElement.innerHTML = '¡Gracias por tu compra, <strong>' + customerName + '</strong>!';
    greetingElement.style.textAlign = 'center';
    greetingElement.style.marginTop = '10px';
    document.querySelector('.form-group, #talleselegidos').parentNode.insertBefore(greetingElement, document.querySelector('.form-group, #talleselegidos').nextSibling);
}

// Facebook Pixel Purchase Event - CBU 1 Par
(function() {
    // Función para generar Event ID único
    function generateEventId() {
        return 'fb_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
    }

    // Función auxiliar para obtener cookies
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return '';
    }

    // Función de envío dual para Purchase
    async function sendPurchaseEvent() {
        const eventId = generateEventId();

        // Datos del evento Purchase - CBU 1 Par ($63.000)
        const eventData = {
            content_type: 'product',
            content_ids: ['1-par-cbu'],
            contents: [{
                id: '1-par-cbu',
                quantity: 1,
                item_price: 63000
            }],
            value: 63000,
            currency: 'ARS',
            num_items: 1
        };

        // 1. Enviar a Facebook (Cliente)
        if (typeof fbq !== 'undefined') {
            fbq('track', 'Purchase', {
                ...eventData,
                event_id: eventId
            });
        }

        // 2. Preparar payload completo de Facebook para N8N
        const facebookPayload = {
            pixel_id: '1052677351596434',
            event_name: 'Purchase',
            event_id: eventId,
            event_time: Math.floor(Date.now() / 1000),
            action_source: 'website',
            event_source_url: window.location.href,
            user_data: {
                client_ip_address: '',
                client_user_agent: navigator.userAgent,
                fbc: getCookie('_fbc') || '',
                fbp: getCookie('_fbp') || ''
            },
            custom_data: eventData
        };

        // 3. Enviar al webhook (Servidor)
        try {
            await fetch('https://sswebhookss.odontolab.co/webhook/9dfb840b-2a21-4277-8aec-1666bfaaac89', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    facebook_payload: facebookPayload,
                    debug_info: {
                        page_type: 'cbu_1par',
                        timestamp: new Date().toISOString()
                    }
                })
            });
        } catch (error) {
            // Error silencioso
        }
    }

    // Ejecutar cuando la página esté cargada
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', sendPurchaseEvent);
    } else {
        sendPurchaseEvent();
    }
})();
</script>
</body>
</html>

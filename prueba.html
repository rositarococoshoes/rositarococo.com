<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-W2CVWDJ');</script>
    <!-- End Google Tag Manager -->

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Rosita Rococ√≥ | Cat√°logo Oto√±o-Invierno 2025</title>
    <meta name="description" content="Descubre la nueva colecci√≥n Oto√±o Invierno 2025 de Rosita Rococ√≥. Borcegos y botas de cuero con env√≠o gratis y cuotas sin inter√©s. ¬°Compr√° online!">

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <!-- Slick Carousel CSS -->
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css"/>
    <link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css"/>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">

    <style type="text/css">
      /* --- Reset & Base --- */
      :root {
          --color-primary: #A0522D; /* Sienna/Terracotta */
          --color-secondary: #D2B48C; /* Tan */
          --color-accent: #CC5500; /* Burnt Orange */
          --color-background: #fdfbf7; /* Light Beige/Cream */
          --color-card-bg: #fffcf7; /* Slightly Creamier White for cards */
          --color-text: #4a4a4a;
          --color-heading: #5D4037; /* Dark Brown */
          --color-border: #e8e0d4; /* Lighter border */
          --color-success: #5D4037; /* Dark brown for success text */
          --color-error: #c0392b; /* Standard red for errors */
          --color-highlight-bg: #fff8e1; /* Light yellow for highlights */
          --color-highlight-text: #5D4037; /* Dark text on highlight */
          --font-primary: 'Lato', sans-serif;
          --font-secondary: 'Merriweather', serif;
          --border-radius: 8px;
          --section-spacing: 45px; /* Consistent vertical spacing */
      }

      * { box-sizing: border-box; margin: 0; padding: 0; }
      html { scroll-behavior: smooth; }
      body { font-family: var(--font-primary); font-size: 16px; line-height: 1.6; color: var(--color-text); background-color: var(--color-background); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; min-height: 100vh; }
      img { max-width: 100%; height: auto; display: block; }
      a { color: var(--color-accent); text-decoration: none; }
      a:hover { text-decoration: underline; }
      h1, h2, h3, h4, h5, h6 { font-family: var(--font-secondary); color: var(--color-heading); margin-bottom: 0.8em; line-height: 1.3; }
      h1 { font-size: 1.8em; margin-top: 0.5em; } /* Adjusted base size */
      h2 { font-size: 1.5em; }
      h3 { font-size: 1.3em; }
      h4 { font-size: 1.15em; margin-bottom: 0.6em; }
      p { margin-bottom: 1.1em; }
      p:last-child { margin-bottom: 0; }
      section, header { margin-bottom: var(--section-spacing); } /* Add bottom margin to sections */
      fieldset { border: 1px solid var(--color-border); padding: 25px; margin-bottom: 30px; border-radius: var(--border-radius); background-color: #fff; }
      legend { font-family: var(--font-secondary); font-weight: bold; font-size: 1.2em; padding: 0 10px; margin-left: 10px; margin-bottom: 15px; /* Add bottom margin */ color: var(--color-heading); float: left; /* Allow content to wrap below */ width: 100%; /* Take full width initially */ }
      /* Clearfix for legend */
      fieldset::after { content: ""; display: table; clear: both; }


      /* --- Layout & Container --- */
      .container { max-width: 960px; margin: 0 auto; padding: 0 15px; } /* Removed top/bottom padding, handled by section margins */
      .form-container { max-width: 550px; margin: 0 auto; padding: 0 15px; } /* Removed top margin */

      /* --- Header --- */
      .site-header { text-align: center; padding-bottom: 30px; border-bottom: 1px solid var(--color-border); margin-bottom: var(--section-spacing); }
      .site-header img { max-width: 230px; margin: 0 auto 20px auto; }
      .site-header h1 { font-size: 1.7em; margin-bottom: 15px; color: var(--color-heading); }
      .site-header p { font-size: 1.05em; line-height: 1.7; margin-bottom: 15px; color: var(--color-text); }
      .site-header .emoji { font-size: 1.1em; vertical-align: -0.1em; display: inline-block; margin: 0 3px; }
      .promo-highlight { color: var(--color-primary); font-weight: bold; }
      #fechahoy { color: var(--color-heading); background-color: var(--color-secondary); padding: 6px 15px; font-weight: bold; text-align: center; font-size: 0.9em; margin: 15px auto 0 auto; border-radius: 20px; display: inline-block; border: none; }

      /* --- Price Summary Box (Repeated & Initial) --- */
      .price-summary-box { background-color: var(--color-highlight-bg); padding: 25px; border: 1px solid #f5e5b8; border-radius: var(--border-radius); margin: var(--section-spacing) 0; text-align: center; }
      .price-summary-box p:first-child { margin: 0 0 18px 0; font-size: 1.1em; font-weight: bold; color: var(--color-heading); }
      .price-summary-box .price-line { font-size: 1.25em; font-weight: bold; margin-bottom: 10px; color: var(--color-accent); }
      .price-summary-box .price-detail { font-size: 0.9em; color: #666; }
      .price-summary-box .discount-info { font-size: 0.9em; background-color: #fff; color: var(--color-highlight-text); padding: 4px 8px; border-radius: 4px; display: inline-block; margin: 8px 0 12px 0; border: 1px solid var(--color-border); }
      .price-summary-box .transfer-discount { color: var(--color-success); font-weight: bold; text-transform: uppercase; font-size: 0.95em; margin-top: 15px; display: block; }

      /* --- Info Section --- */
      .info-section { font-size: 0.98em; line-height: 1.8; margin: var(--section-spacing) 0; padding: 25px; background-color: var(--color-card-bg); border: 1px solid var(--color-border); border-radius: var(--border-radius); }
      .info-section span { display: flex; align-items: baseline; margin-bottom: 12px; }
      .info-section small span { font-weight: bold; color: var(--color-heading); } /* Target the bold span directly */
      .info-section .emoji { margin-right: 12px; font-size: 1.1em; min-width: 1.3em; /* Ensure alignment */ display: inline-block; text-align: center; vertical-align: -0.1em; }

      /* --- How to Buy Section --- */
      .how-to-buy { margin-bottom: var(--section-spacing); background-color: var(--color-card-bg); padding: 30px; border: 1px solid var(--color-border); border-radius: var(--border-radius); }
      .how-to-buy h3 { margin-bottom: 15px; color: var(--color-primary); }
      .how-to-buy ol { padding-left: 25px; margin: 0; font-size: 0.98em; }
      .how-to-buy li { margin-bottom: 10px; color: var(--color-text); }
      .how-to-buy li::marker { color: var(--color-primary); font-weight: bold; }
      .how-to-buy strong { color: var(--color-heading); }

      /* --- Product Catalog Grid --- */
      #todoslosmodelos { display: grid; grid-template-columns: repeat(auto-fit, minmax(290px, 1fr)); gap: 30px; /* No border/padding needed */ }
      .product-card { background-color: var(--color-card-bg); border: 1px solid var(--color-border); border-radius: var(--border-radius); overflow: hidden; box-shadow: 0 3px 8px rgba(0,0,0,0.06); transition: box-shadow 0.3s ease; display: flex; flex-direction: column; /* Important for structure */ }
      .product-card:hover { box-shadow: 0 6px 15px rgba(0,0,0,0.1); }

      /* --- Carousel Styles (Inside Product Card) --- */
      .slick-slider { margin-bottom: 0 !important; position: relative; } /* Remove default Slick margin */
      .slick-list { /* Container for slides */ overflow: hidden; border-radius: var(--border-radius) var(--border-radius) 0 0; }
      .slick-track { display: flex; align-items: center; } /* Align slides vertically if adaptiveHeight is used */
      .slick-slide { float: left; height: 100%; min-height: 1px; outline: none; }
      .slick-slide img { display: block; margin: 0 auto; } /* Center image if needed */
      .model-carousel { width: 100%; position: relative; }
      .model-carousel .slick-slide { background-color: #fff; /* White background behind images */ cursor: pointer; }
      .model-carousel .slick-slide img {
          width: 100%;
          height: 320px; /* Fixed height as per original code - ADJUST IF NEEDED */
          object-fit: cover; /* 'cover' crops, 'contain' fits without cropping */
          /* Consider 'contain' if 'no cortadas' is absolute priority, or use adaptiveHeight in JS */
      }
      .model-carousel label[for] { display: block; cursor: pointer; } /* Make image clickable for select */
      /* Slick Arrows */
      .slick-prev, .slick-next { z-index: 1; width: 38px; height: 38px; background: rgba(255, 255, 255, 0.85); border-radius: 50%; }
      .slick-prev:hover, .slick-next:hover { background: rgba(93, 64, 55, 0.9); /* Darker background on hover */ }
      .slick-prev:before, .slick-next:before { color: var(--color-primary); font-size: 20px; opacity: 0.8; transition: color 0.2s; }
      .slick-prev:hover:before, .slick-next:hover:before { color: white; opacity: 1; }
      .slick-prev { left: 12px; }
      .slick-next { right: 12px; }
      /* Slick Dots */
      .slick-dots { bottom: 12px; }
      .slick-dots li { margin: 0 6px; }
      .slick-dots li button { width: 10px; height: 10px; padding: 0; }
      .slick-dots li button:before { font-size: 10px; line-height: 10px; width: 10px; height: 10px; color: #aaaaaa; opacity: 0.8; transition: color 0.2s; }
      .slick-dots li.slick-active button:before { color: var(--color-primary); opacity: 1; }

      /* --- Product Details (Inside Product Card) --- */
      .product-details { padding: 25px; text-align: center; font-size: 0.95em; border-top: 1px solid var(--color-border); flex-grow: 1; /* Allows this section to fill space */ display: flex; flex-direction: column; justify-content: space-between; /* Pushes selection down */ }
      .product-info { margin-bottom: 18px; color: var(--color-text); line-height: 1.7; }
      .product-info span { display: block; margin-bottom: 6px; }
      .product-info strong { color: var(--color-heading); }
      .product-pricing { margin-bottom: 18px; }
      .product-pricing .price { font-size: 1.1em; font-weight: bold; color: var(--color-primary); display: block; margin-bottom: 8px; }
      .product-pricing .discount-info { font-size: 0.85em; background-color: var(--color-highlight-bg); color: var(--color-highlight-text); padding: 4px 8px; border-radius: 4px; display: inline-block; margin-bottom: 10px; border: 1px solid #f5e5b8; }
      .product-pricing .transfer-discount { color: var(--color-success); font-weight: bold; text-transform: uppercase; font-size: 0.9em; margin-top: 8px; display: block; }
      .quantity-select label { margin: 0 12px; cursor: pointer; display: inline-flex; align-items: center; font-size: 1em; }
      .quantity-select input[type="radio"] { margin-left: 8px; width: 18px; height: 18px; accent-color: var(--color-primary); vertical-align: middle; /* Align radio */ }
      .quantity-label { display: block; margin-bottom: 10px; font-weight: bold; color: var(--color-heading); font-size: 1em; }
      .size-selection { margin-top: auto; /* Pushes this group to the bottom */ padding-top: 15px; /* Space above selection */ }
      .size-selection fieldset { border: none; padding: 0; margin-top: 10px; /* Reduced margin */ }
      .fieldsetstalles { display: none; } /* Hide second size initially */
      .size-selection .form-group { margin-bottom: 0; }
      .size-selection select.talle { font-size: 0.95em; }

      /* --- Testimonials Section --- */
      .testimonials-section { background-color: var(--color-card-bg); padding: 35px 20px; border-radius: var(--border-radius); border: 1px solid var(--color-border); }
      .testimonials-section h2 { text-align: center; margin-bottom: 30px; }
      .testimonials-carousel { max-width: 600px; margin: 0 auto; }
      .testimonials-carousel .slick-slide img { width: 100%; height: auto; max-height: 500px; object-fit: contain; border: 1px solid #eee; border-radius: 4px; }
      /* Using default dots from product card */

       /* --- Form Styles --- */
      #restodelform { display: none; /* Hidden initially */ background-color: var(--color-card-bg); padding: 30px 35px; border: 1px solid var(--color-border); border-radius: var(--border-radius); margin-top: var(--section-spacing); /* Add top margin when visible */ }
      #restodelform h2 { text-align: center; margin-bottom: 35px; font-size: 1.6em; }
      #restodelform h2 .emoji { vertical-align: -0.1em; margin: 0 5px; }
      .form-group { margin-bottom: 20px; /* Consistent spacing */ }
      .form-group label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 0.95em; color: var(--color-heading); }
      .form-control { display: block; width: 100%; padding: 12px 15px; /* Generous padding */ font-size: 1em; line-height: 1.5; color: var(--color-text); background-color: #fff; background-clip: padding-box; border: 1px solid var(--color-border); border-radius: 5px; transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out; vertical-align: middle; }
      .form-control:focus { border-color: var(--color-secondary); outline: 0; box-shadow: 0 0 0 0.2rem rgba(210, 180, 140, 0.3); }
      .form-control[readonly] { background-color: #f8f6f2; opacity: 0.8; cursor: not-allowed; }
      select.form-control { height: auto; /* Let padding define height */ appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='none' stroke='%235D4037' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 0.9rem center; background-size: 12px 12px; padding-right: 2.5rem; }
      /* Specific style for summary textarea */
      textarea#1471599855 { min-height: 70px; line-height: 1.5; font-size: 0.9em; }
      .help-block { font-size: 0.88em; color: #777; margin-top: 8px; }
      /* Order Summary in Form */
      #confirma-pedido { background-color: #fffcf7; padding: 25px; border-radius: var(--border-radius); border: 1px solid var(--color-border); margin-top: 30px; }
      #confirma-pedido h3 { font-size: 1.3em; margin-bottom: 25px; text-align: center; color: var(--color-primary); }
      #confirma-pedido .summary-item { margin-bottom: 12px; font-size: 1em; line-height: 1.5; }
      #confirma-pedido .summary-label { font-weight: bold; color: var(--color-heading); margin-right: 8px; }
      #confirma-pedido .summary-value { color: var(--color-text); word-break: break-word; /* Prevent long summary overflow */ }
      #preciototal { font-size: 1.25em; font-weight: bold; text-align: center; margin-top: 25px; padding-top: 25px; border-top: 1px dashed var(--color-border); }
      #preciototal .preciototalaobservar { color: var(--color-accent); }
      #preciototal .shipping-free { color: var(--color-success); font-size: 0.9em; font-weight: normal; display: inline-block; margin-left: 5px; }
      #preciototal .add-more-info { font-size: 0.85em; color: #6c757d; font-weight: normal; display: block; margin-top: 8px; }
      #confirma-pedido fieldset { margin-top: 30px; border-color: var(--color-secondary); background-color: #fff; }
      #confirma-pedido legend { color: var(--color-primary); margin-bottom: 20px; }
      #comoabona { background-color: #fff; }
      .commitment-warning { text-align: center; margin: 30px 0; font-size: 0.95em; background-color: var(--color-highlight-bg); padding: 15px; border-radius: var(--border-radius); border: 1px solid #f5e5b8; color: var(--color-highlight-text); }
      .commitment-warning .emoji { font-size: 1.2em; vertical-align: -0.1em; }
      /* Submit Button */
      #botoncomprar { width: 100%; padding: 14px 20px; font-size: 1.25em; font-family: var(--font-secondary); font-weight: bold; background-color: var(--color-accent); color: white; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease, opacity 0.2s ease; margin-top: 30px; margin-bottom: 0; letter-spacing: 0.5px; }
      #botoncomprar:hover { background-color: #a54400; /* Darker accent */ }
      #botoncomprar:disabled { background-color: #cccccc; cursor: not-allowed; opacity: 0.7; }
      #botoncomprar .emoji { margin-left: 8px; vertical-align: -0.1em; }

      /* --- Floating Elements & Overlays --- */
      #text { /* Bottom Bar */
            display: none; /* Initial */
            font-size: 12px;
            position: fixed;
            width: 100%;
            left: 0;
            padding: 10px 15px;
            min-height: 55px; /* Ensure enough height */
            bottom: 0;
            background-color: var(--color-heading);
            color: var(--color-background);
            margin: 0;
            z-index: 998;
            border-top: 1px solid #4a3027; /* Darker border top */
            box-shadow: 0 -3px 10px rgba(0,0,0,0.15);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px; /* Space between text and button */
        }
         #text-content {
             flex-grow: 1; /* Allow text to take available space */
             flex-shrink: 1; /* Allow text to shrink if needed */
             overflow: hidden; /* Hide overflow */
             line-height: 1.4;
         }
         #text-content b { /* Label like "PEDIDO (1 par):" */
             display: block;
             font-size: 1em; /* Relative to bar font size */
             margin-bottom: 2px;
             font-weight: bold;
             color: #fff;
             white-space: nowrap; /* Prevent label wrapping */
         }
         #text-content span:not(#preciototal2) { /* The summary text */
            display: block; /* Ensure it's on its own line */
            white-space: normal; /* Allow wrapping */
         }
         #preciototal2 { /* Price in bar */
             font-weight: bold;
             color: var(--color-secondary); /* Tan color for price */
             font-size: 1.1em; /* Slightly larger price */
             display: block;
             margin-top: 3px;
         }
         #finalizarpedido { /* Button in bar */
            font-size: 13px;
            padding: 8px 14px;
            background-color: var(--color-accent);
            border: none;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            white-space: nowrap; /* Prevent button text wrapping */
            transition: background-color 0.2s ease;
            flex-shrink: 0; /* Prevent button from shrinking */
            font-weight: bold;
            margin-left: auto; /* Pushes button right if space allows */
        }
         #finalizarpedido:hover { background-color: #a54400; }

      #region { /* Top Promo bar */
            font-size: 13px;
            display: none; /* Hidden initially */
            background-color: var(--color-primary);
            color: white;
            padding: 10px 15px;
            position: fixed;
            font-weight: bold;
            z-index: 1000; /* Above most content */
            top: 0;
            width: 100%;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
         #region .emoji { vertical-align: -0.1em; font-size: 1.1em; }

      #whatsapp { /* WhatsApp Button */
            display: none; /* Hidden initially */
            position: fixed;
            width: 55px;
            height: 55px;
            bottom: 80px; /* INCREASED: Position above taller bottom bar */
            right: 15px;
            z-index: 999; /* Above bottom bar */
            transition: opacity 0.3s ease;
        }
        #whatsapp img { width: 100%; height: 100%; filter: drop-shadow(0 3px 6px rgba(0,0,0,0.25)); }

        /* Loading Overlay */
        .loading-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(253, 251, 247, 0.92); backdrop-filter: blur(5px); z-index: 10001; /* Above everything */ display: flex; align-items: center; justify-content: center; text-align: center; }
        .loading-content { background: white; padding: 35px 45px; border-radius: var(--border-radius); box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
        .loading-spinner { width: 45px; height: 45px; border: 5px solid #f3f3f3; border-top: 5px solid var(--color-accent); border-radius: 50%; margin: 0 auto 25px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .loading-message { color: var(--color-heading); font-size: 1.05em; margin: 0; line-height: 1.6; }

        /* Error Messages (WhatsApp Validation) */
        .error-message { display: none; font-size: 0.9em; margin-top: 8px; padding: 10px 12px; border-radius: 4px; text-align: center; font-weight: 500; border: 1px solid transparent; transition: opacity 0.3s ease; }
        .error-message.verifying { display: block; background-color: #e2f3fd; color: #0c5460; border-color: #b8daff; animation: pulse 1.5s infinite ease-in-out; }
        .error-message.valid { display: block; background-color: #d4edda; color: #155724; border-color: #c3e6cb; }
        .error-message.invalid { display: block; background-color: #f8d7da; color: #721c24; border-color: #f5c6cb; }
        .error-message.api-error { display: block; background-color: #fff3cd; color: #856404; border-color: #ffeeba; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        /* Item Added Confirmation (Sticky Top) */
        .avisoagregado-fixed { font-size: 14px; line-height: 1.5; color: white; font-weight: bold; border: none; background-color: var(--color-success); text-align: center; top: 60px; /* Below sticky promo bar */ max-width: 90%; width: 350px; padding: 10px 15px; z-index: 5001; position: fixed; left: 50%; transform: translateX(-50%); border-radius: 5px; box-shadow: 0 3px 8px rgba(0,0,0,0.2); }

        /* Utility */
        .hidden { position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0; } /* Screen reader only */
        .text-center { text-align: center; }

        /* jQuery UI Autocomplete */
        .ui-autocomplete { z-index: 1001; border-radius: 5px; border: 1px solid var(--color-border); box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1); background: #fff; }
        .ui-menu-item { padding: 10px 14px; font-size: 0.95em; color: var(--color-text); }
        .ui-menu-item.ui-state-focus, .ui-menu-item.ui-state-active { background-color: var(--color-primary); color: #ffffff; border: none; margin: 0; border-radius: 0; }

        /* --- Notifications --- */
        #notification-container {
            position: fixed;
            bottom: 70px; /* Adjusted position above bottom bar */
            left: 15px;
            z-index: 997; /* Below bottom bar, above content */
            width: calc(100% - 30px);
            max-width: 360px;
            pointer-events: none; /* Container doesn't block clicks */
        }
        .notification { display: flex; align-items: center; padding: 12px 15px; background-color: white; box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.18); border-radius: var(--border-radius); margin-bottom: 12px; opacity: 0; transform: translateX(-110%); animation: slideInLeft 0.6s cubic-bezier(0.25, 0.8, 0.25, 1) forwards; position: relative; pointer-events: auto; /* Individual notifications are clickable */ }
        @keyframes slideInLeft { to { opacity: 1; transform: translateX(0); } }
        .notification img { height: 60px; width: 60px; border-radius: 6px; object-fit: cover; margin-right: 15px; flex-shrink: 0; }
        .notification .order-info { flex-grow: 1; line-height: 1.4; }
        .notification .order-info h3 { margin: 0 0 4px 0; font-size: 13px; font-weight: 700; color: var(--color-heading); }
        .notification .order-info p { margin: 2px 0; font-size: 12px; color: #555; }
        .notification .customer-info { display: flex; align-items: center; justify-content: space-between; }
        .notification .city { font-size: 11px; color: #777; }
        .notification .close { position: absolute; top: 8px; right: 8px; width: 22px; height: 22px; text-align: center; line-height: 20px; font-size: 14px; font-weight: bold; color: #aaa; cursor: pointer; background: #f0f0f0; border-radius: 50%; border: none; padding: 0; transition: background-color 0.2s, color 0.2s; }
        .notification .close:hover { color: #fff; background: var(--color-error); }

      /* --- Responsiveness --- */
      @media (max-width: 768px) {
          :root { --section-spacing: 35px; }
          .container { padding: 0 10px; }
          .form-container { padding: 0 10px; }
          h1 { font-size: 1.6em; } h2 { font-size: 1.3em; }
          #todoslosmodelos { gap: 20px; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); }
          .model-carousel .slick-slide img { height: 290px; } /* Adjust height for smaller screens */
          .testimonials-section { padding: 25px 15px; }
          #text { min-height: 50px; padding: 8px 10px; gap: 10px; }
          #text-content { font-size: 11px; }
          #finalizarpedido { font-size: 12px; padding: 7px 12px; }
          #whatsapp { bottom: 70px; /* Adjust slightly */ width: 50px; height: 50px; right: 10px; }
          #notification-container { bottom: 65px; left: 10px; max-width: 320px; }
          fieldset { padding: 20px; }
          #restodelform { padding: 25px; }
      }

      @media (max-width: 480px) {
           :root { --section-spacing: 30px; }
          body { font-size: 15px; }
          h1 { font-size: 1.4em; }
          #todoslosmodelos { grid-template-columns: 1fr; gap: 25px; } /* Single column */
          .model-carousel .slick-slide img { height: 280px; /* Further adjust height */ }
          .form-container { padding: 0 5px; }
          fieldset { padding: 15px; } legend { font-size: 1.1em; }
          #botoncomprar { font-size: 1.15em; padding: 12px 15px; }
          #text { /* Adjust bottom bar for small screens */
              min-height: 55px;
              padding: 10px 12px;
              flex-wrap: wrap; /* Allow wrapping if needed */
              gap: 5px 10px; /* Row and column gap */
          }
          #text-content {
              flex-basis: 100%; /* Allow text to take full width if it wraps */
              text-align: center; /* Center text if wrapped */
              font-size: 11px; /* Keep small */
          }
          #text-content b { display: inline; margin-right: 5px; } /* Inline label */
          #text-content span:not(#preciototal2) { display: inline; } /* Inline summary */
          #preciototal2 { display: inline; margin-left: 5px; font-size: 1em; } /* Inline price */

          #finalizarpedido {
              flex-basis: 100%; /* Button takes full width when wrapped */
              font-size: 13px; /* Make button slightly larger */
              padding: 9px 12px;
              margin-left: 0; /* Remove margin when full width */
              text-align: center;
          }
          #whatsapp { bottom: 95px; /* INCREASED position due to potentially taller wrapped bottom bar */ width: 48px; height: 48px; }
          .info-section, .how-to-buy, .price-summary-box { padding: 20px; }
          #notification-container { bottom: 110px; /* Adjust for potentially taller bar */ max-width: calc(100% - 20px); width: auto; left: 10px; }
      }
    </style>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W2CVWDJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="region" style="display: none;"></div> <!-- Top Promo Bar - Content added via JS -->

    <header class="site-header container">
         <img alt="Rosita Rococ√≥ Logo" src="rosita-form.webp" loading="lazy"/>
        <h1>
            <span class="emoji">üçÇ</span> Nueva Temporada <span class="promo-highlight">Oto√±o Invierno 2025</span> <span class="emoji">üçÇ</span>
        </h1>
        <p>
             <span class="emoji">üí∞</span> <span style="font-weight: bold;">DESCUENTO ESPECIAL</span> llevando dos pares
             <br> <span class="emoji">üí≥</span> 3 Cuotas sin inter√©s y <span class="emoji">üöö</span> <span style="font-weight: bold;">Env√≠o GRATIS</span> a todo el pa√≠s
        </p>
        <div id="fechahoy" style="display:none;"></div>
    </header>

    <main class="container">

        <section class="price-summary-box" aria-label="Resumen de Precios de Lanzamiento">
             <p>¬°Aprovech√° los precios de Lanzamiento!</p>
            <div class="price-line">1 par: üî• $70.000</div>
            <div class="price-line">2 pares: üî• $110.000 <span class="price-detail">($55.000 c/par)</span></div>
            <span class="discount-info">Pod√©s combinar modelos en tu mismo pedido</span>
            <p class="transfer-discount">10% OFF ADICIONAL por Transferencia</p>
        </section>

        <section class="info-section" aria-label="Informaci√≥n Importante">
             <span><span class="emoji">üöö</span> <small><span style="font-weight: 700;">ENV√çO GRATIS</span> a domicilio o sucursal.</small></span>
             <span><span class="emoji">üí≥</span> <small><span style="font-weight: 700;">PAGO:</span> Tarjeta (3 cuotas sin inter√©s), MercadoPago, Transferencia (10% OFF).</small></span>
             <span><span class="emoji">‚åõ</span> <small><span style="font-weight: 700;">DESPACHO:</span> 15 d√≠as aprox. (Producimos a pedido con mucho ‚ù§Ô∏è).</small></span>
             <span><span class="emoji">‚úÖ</span> <small><span style="font-weight: 700;">STOCK:</span> Disponible en todos los modelos publicados.</small></span>
             <span><span class="emoji">üìè</span> <small><span style="font-weight: 700;">TALLES:</span> Del 35 al 40. Ver medida en cm en cada talle.</small></span>
        </section>

        <section class="how-to-buy" aria-label="C√≥mo Comprar">
             <h3>¬øC√≥mo comprar f√°cil y r√°pido?</h3>
             <ol>
                 <li><strong>Eleg√≠ talle y cantidad</strong> de cada modelo que te guste (M√°x. 2 pares).</li>
                 <li>Una vez listo, <strong>desplazate hacia abajo</strong>.</li>
                 <li><strong>Complet√° tus datos</strong> de env√≠o y seleccion√° tu forma de pago.</li>
                 <li>¬°Listo! Finaliz√° la compra y prepararemos tu pedido.</li>
             </ol>
         </section>

        {/* Product Catalog Grid */}
        <section id="todoslosmodelos" aria-label="Cat√°logo de Productos">

            <article class="product-card" id="modeload-roma-negras">
                 <div class="model-carousel">
                    <div><label for="talle-select-roma-negras-1"><img src="roma-negras-1.jpg" alt="Borcego Roma Negro Vista 1" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-negras-1"><img data-lazy="roma-negras-1a.jpg" alt="Borcego Roma Negro Vista 2" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-negras-1"><img data-lazy="roma-negras-5a.jpg" alt="Borcego Roma Negro Vista 3" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-negras-1"><img data-lazy="roma-negras-2a.jpg" alt="Borcego Roma Negro Vista 4" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-negras-1"><img data-lazy="roma-negras-3a.jpg" alt="Borcego Roma Negro Vista 5" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-negras-1"><img data-lazy="roma-negras-4a.jpg" alt="Borcego Roma Negro Detalle" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-negras-1"><img data-lazy="roma-negras-2.jpg" alt="Borcego Roma Negro Vista 6" loading="lazy"></label></div>
                </div>
                <div class="product-details">
                    <div> <!-- Content grouping div -->
                        <h4>Borcego ROMA Negro</h4>
                         <div class="product-info">
                            <span><strong>MATERIAL:</strong> Cuero Vacuno</span>
                            <span><strong>SUELA:</strong> Expanso ultra liviano</span>
                            <span><strong>HORMA:</strong> Normal</span>
                        </div>
                        <div class="product-pricing">
                            <span class="price">1 par: $70.000 | 2 pares: $110.000</span>
                            <span class="discount-info">Combin√° modelos como quieras</span>
                            <span class="transfer-discount">10% OFF extra por Transferencia</span>
                        </div>
                    </div>
                    <div class="size-selection"> <!-- Selection grouping div -->
                        <div class="quantity-select">
                            <span class="quantity-label">Cantidad:</span>
                            <label>1 <input checked name="hwA-qty-roma-negras" type="radio" value="1"></label>
                            <label>2 <input name="hwA-qty-roma-negras" type="radio" value="2"></label>
                        </div>
                        <fieldset id="hwA-roma-negras-1">
                            <div class="form-group">
                                <label for="talle-select-roma-negras-1" class="hidden">Seleccione Talle 1 para Roma Negro</label>
                                <select id="talle-select-roma-negras-1" class="form-control talle">
                                    <option value="">-- Talle par 1 --</option>
                                    <option value="35-roma-negras">35 (23 cm)</option>
                                    <option value="36-roma-negras">36 (23,5 cm)</option>
                                    <option value="37-roma-negras">37 (24 cm)</option>
                                    <option value="38-roma-negras">38 (25 cm)</option>
                                    <option value="39-roma-negras">39 (25,5 cm)</option>
                                    <option value="40-roma-negras">40 (26 cm)</option>
                                </select>
                            </div>
                        </fieldset>
                        <fieldset class="fieldsetstalles" id="hwA-roma-negras-2">
                            <div class="form-group">
                                <label for="talle-select-roma-negras-2" class="hidden">Seleccione Talle 2 para Roma Negro</label>
                                <select id="talle-select-roma-negras-2" class="form-control talle">
                                     <option value="">-- Talle par 2 --</option>
                                    <option value="35-roma-negras">35 (23 cm)</option>
                                    <option value="36-roma-negras">36 (23,5 cm)</option>
                                    <option value="37-roma-negras">37 (24 cm)</option>
                                    <option value="38-roma-negras">38 (25 cm)</option>
                                    <option value="39-roma-negras">39 (25,5 cm)</option>
                                    <option value="40-roma-negras">40 (26 cm)</option>
                                </select>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </article>

            <article class="product-card" id="modeload-roma-suela">
                   <div class="model-carousel">
                    <div><label for="talle-select-roma-suela-1"><img src="roma-suela-1a.jpg" alt="Borcego Roma Suela Vista 1" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-suela-1"><img data-lazy="roma-suela-2a.jpg" alt="Borcego Roma Suela Vista 2" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-suela-1"><img data-lazy="roma-suela-1.jpg" alt="Borcego Roma Suela Vista 3" loading="lazy"></label></div>
                    <div><label for="talle-select-roma-suela-1"><img data-lazy="roma-suela-2.jpg" alt="Borcego Roma Suela Detalle" loading="lazy"></label></div>
                </div>
                 <div class="product-details">
                    <div>
                        <h4>Borcego ROMA Suela</h4>
                         <div class="product-info">
                             <span><strong>MATERIAL:</strong> Cuero Vacuno</span>
                             <span><strong>SUELA:</strong> Expanso ultra liviano</span>
                             <span><strong>HORMA:</strong> Normal</span>
                        </div>
                        <div class="product-pricing">
                            <span class="price">1 par: $70.000 | 2 pares: $110.000</span>
                            <span class="discount-info">Combin√° modelos como quieras</span>
                            <span class="transfer-discount">10% OFF extra por Transferencia</span>
                        </div>
                    </div>
                    <div class="size-selection">
                        <div class="quantity-select">
                            <span class="quantity-label">Cantidad:</span>
                            <label>1 <input checked name="hwA-qty-roma-suela" type="radio" value="1"></label>
                            <label>2 <input name="hwA-qty-roma-suela" type="radio" value="2"></label>
                        </div>
                        <fieldset id="hwA-roma-suela-1">
                            <div class="form-group">
                                <label for="talle-select-roma-suela-1" class="hidden">Seleccione Talle 1 para Roma Suela</label>
                                <select id="talle-select-roma-suela-1" class="form-control talle">
                                    <option value="">-- Talle par 1 --</option>
                                    <option value="35-roma-suela">35 (23 cm)</option>
                                    <option value="36-roma-suela">36 (23,5 cm)</option>
                                    <option value="37-roma-suela">37 (24 cm)</option>
                                    <option value="38-roma-suela">38 (25 cm)</option>
                                    <option value="39-roma-suela">39 (25,5 cm)</option>
                                    <option value="40-roma-suela">40 (26 cm)</option>
                                </select>
                            </div>
                        </fieldset>
                        <fieldset class="fieldsetstalles" id="hwA-roma-suela-2">
                            <div class="form-group">
                                 <label for="talle-select-roma-suela-2" class="hidden">Seleccione Talle 2 para Roma Suela</label>
                                <select id="talle-select-roma-suela-2" class="form-control talle">
                                    <option value="">-- Talle par 2 --</option>
                                    <option value="35-roma-suela">35 (23 cm)</option>
                                    <option value="36-roma-suela">36 (23,5 cm)</option>
                                    <option value="37-roma-suela">37 (24 cm)</option>
                                    <option value="38-roma-suela">38 (25 cm)</option>
                                    <option value="39-roma-suela">39 (25,5 cm)</option>
                                    <option value="40-roma-suela">40 (26 cm)</option>
                                </select>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </article>

            <article class="product-card" id="modeload-siena2025">
                    <div class="model-carousel">
                        <div><label for="talle-select-siena2025-1"><img src="siena2025-1.webp" alt="Borcego Siena 2025 Negro Vista 1" loading="lazy"></label></div>
                        <div><label for="talle-select-siena2025-1"><img data-lazy="siena2025-2.webp" alt="Borcego Siena 2025 Negro Vista 2" loading="lazy"></label></div>
                    </div>
                 <div class="product-details">
                    <div>
                         <h4>Borcego SIENA Negro</h4>
                         <div class="product-info">
                            <span><strong>MATERIAL:</strong> Cuero Vacuno</span>
                             <span><strong>SUELA:</strong> Expanso ultra liviano</span>
                             <span><strong>HORMA:</strong> Normal</span>
                        </div>
                        <div class="product-pricing">
                            <span class="price">1 par: $70.000 | 2 pares: $110.000</span>
                            <span class="discount-info">Combin√° modelos como quieras</span>
                            <span class="transfer-discount">10% OFF extra por Transferencia</span>
                        </div>
                    </div>
                     <div class="size-selection">
                         <div class="quantity-select">
                             <span class="quantity-label">Cantidad:</span>
                            <label>1 <input checked name="hwA-qty-siena2025" type="radio" value="1"></label>
                            <label>2 <input name="hwA-qty-siena2025" type="radio" value="2"></label>
                        </div>
                        <fieldset id="hwA-siena2025-1">
                            <div class="form-group">
                                <label for="talle-select-siena2025-1" class="hidden">Seleccione Talle 1 para Siena Negro</label>
                                <select id="talle-select-siena2025-1" class="form-control talle">
                                    <option value="">-- Talle par 1 --</option>
                                    <option value="35-siena2025">35 (23 cm)</option>
                                    <option value="36-siena2025">36 (23,5 cm)</option>
                                    <option value="37-siena2025">37 (24 cm)</option>
                                    <option value="38-siena2025">38 (25 cm)</option>
                                    <option value="39-siena2025">39 (25,5 cm)</option>
                                    <option value="40-siena2025">40 (26 cm)</option>
                                </select>
                            </div>
                        </fieldset>
                       <fieldset class="fieldsetstalles" id="hwA-siena2025-2">
                            <div class="form-group">
                                <label for="talle-select-siena2025-2" class="hidden">Seleccione Talle 2 para Siena Negro</label>
                                <select id="talle-select-siena2025-2" class="form-control talle">
                                    <option value="">-- Talle par 2 --</option>
                                    <option value="35-siena2025">35 (23 cm)</option>
                                    <option value="36-siena2025">36 (23,5 cm)</option>
                                    <option value="37-siena2025">37 (24 cm)</option>
                                    <option value="38-siena2025">38 (25 cm)</option>
                                    <option value="39-siena2025">39 (25,5 cm)</option>
                                    <option value="40-siena2025">40 (26 cm)</option>
                                </select>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </article>

            <!-- Agrega m√°s art√≠culos de producto aqu√≠ si es necesario -->

        </section>

        {/* Testimonials Section */}
         <section class="testimonials-section" aria-label="Testimonios de Clientes">
             <h2><span class="emoji">üòä</span> Lo que dicen nuestras clientas <span class="emoji">üòä</span></h2>
            <div class="testimonials-carousel">
                <div><img alt="Comentario Cliente 1" data-lazy="comentariorecibi1.webp" loading="lazy" /></div>
                <div><img alt="Comentario Cliente 2" data-lazy="comentariorecibi2.webp" loading="lazy" /></div>
                <div><img alt="Comentario Cliente 4" data-lazy="comentariorecibi4.webp" loading="lazy" /></div>
                <div><img alt="Comentario Cliente 5" data-lazy="comentariorecibi5.webp" loading="lazy" /></div>
                <div><img alt="Comentario Cliente 6" data-lazy="comentariorecibi6.webp" loading="lazy" /></div>
                <div><img alt="Comentario Cliente 7" data-lazy="comentariorecibi7.webp" loading="lazy" /></div>
                <div><img alt="Comentario Cliente 8" data-lazy="comentariorecibi8.webp" loading="lazy" /></div>
                <div><img alt="Comentarios Instagram" src="comentariosig.webp" loading="lazy" ></div>
                <div><img alt="Referencia Cliente 3" data-lazy="comentario3-min.webp" loading="lazy" /></div>
                <div><img alt="Referencia Cliente 4" data-lazy="comentario4-min.webp" loading="lazy" /></div>
                <div><img alt="Referencia Cliente 5" data-lazy="comentario5-min.webp" loading="lazy" /></div>
            </div>
         </section>

        {/* Repeat Price Summary */}
         <section class="price-summary-box" aria-label="Recordatorio de Precios">
             <p>Recordatorio de Precios:</p>
             <div class="price-line">1 par: üî• $70.000</div>
             <div class="price-line">2 pares: üî• $110.000 <span class="price-detail">($55.000 c/par)</span></div>
             <span class="discount-info">Pod√©s pedir diferentes modelos</span>
             <p class="transfer-discount">10% OFF ADICIONAL por Transferencia</p>
         </section>

        {/* ORDER FORM SECTION */}
         <section class="form-container" aria-label="Formulario de Pedido">
            <form action="https://docs.google.com/forms/d/e/1FAIpQLSd_KUORaRPQHoCM6B0GGp_fqI5eiAH0KM2Iwj1mXTgGEjawnQ/formResponse" id="bootstrapForm" method="POST" target="_self" novalidate>

                 {/* Honeypot Field (Anti-spam) */}
                <input type="text" name="website" id="website" class="hidden" tabindex="-1" autocomplete="off">

                 {/* Form content - initially hidden */}
                 <div id="restodelform" style="display: none;">
                     <h2><span class="emoji">üõí</span> Complet√° tu Pedido <span class="emoji">üõí</span></h2>

                     <fieldset>
                         <legend>Modelos Seleccionados</legend>
                         <div class="form-group">
                             <label for="1471599855" class="hidden">Resumen de talles y modelos seleccionados</label>
                             <textarea class="form-control" id="1471599855" name="entry.1471599855" readonly rows="3"></textarea>
                             <p class="help-block">Revis√° que los talles y modelos sean correctos. M√°ximo 2 pares.</p>
                         </div>
                     </fieldset>

                     <fieldset>
                        <legend>Datos de Contacto</legend>
                        <div class="form-group">
                            <label for="1465946249">Email <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="1465946249" name="entry.1465946249" placeholder="ejemplo@email.com" required type="email" />
                            <p class="help-block">Importante: Usaremos este email para confirmaci√≥n y seguimiento.</p>
                        </div>
                         <div class="form-group">
                            <label for="1460904554">Nombre y Apellido <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="1460904554" name="entry.1460904554" required type="text" />
                        </div>
                        <div class="form-group">
                            <label for="53830725">WhatsApp <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="53830725" name="entry.53830725" placeholder="Ej: 1156357659 (sin 0, sin 15, sin +54)" required type="tel" />
                            <div class="error-message" style="display: none;"></div> {/* Placeholder for WP validation */}
                            <p class="help-block">Necesario para coordinar el env√≠o y enviarte el seguimiento.</p>
                        </div>
                         <div class="form-group">
                            <label for="541001873">D.N.I <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="541001873" name="entry.541001873" required type="text" inputmode="numeric" />
                            <p class="help-block">Requerido por el correo para el env√≠o.</p>
                        </div>
                    </fieldset>

                    <fieldset>
                        <legend>Direcci√≥n de Env√≠o</legend>
                        <p class="help-block" style="margin-bottom: 15px;">Complet√° con cuidado tus datos para el env√≠o GRATIS a domicilio.</p>
                        <div class="form-group">
                            <label for="59648134">Provincia <span style="color:var(--color-error)">*</span></label>
                            <select class="form-control" id="59648134" name="entry.59648134" required>
                                <option value="">Seleccione su provincia</option>
                                <option value="Buenos Aires">Buenos Aires</option>
                                <option value="Capital Federal">CABA</option>
                                <option value="Catamarca">Catamarca</option>
                                <option value="Chaco">Chaco</option>
                                <option value="Chubut">Chubut</option>
                                <option value="C√≥rdoba">C√≥rdoba</option>
                                <option value="Corrientes">Corrientes</option>
                                <option value="Entre R√≠os">Entre R√≠os</option>
                                <option value="Formosa">Formosa</option>
                                <option value="Jujuy">Jujuy</option>
                                <option value="La Pampa">La Pampa</option>
                                <option value="La Rioja">La Rioja</option>
                                <option value="Mendoza">Mendoza</option>
                                <option value="Misiones">Misiones</option>
                                <option value="Neuqu√©n">Neuqu√©n</option>
                                <option value="R√≠o Negro">R√≠o Negro</option>
                                <option value="Salta">Salta</option>
                                <option value="San Juan">San Juan</option>
                                <option value="San Luis">San Luis</option>
                                <option value="Santa Cruz">Santa Cruz</option>
                                <option value="Santa Fe">Santa Fe</option>
                                <option value="Santiago del Estero">Santiago del Estero</option>
                                <option value="Tierra del Fuego">Tierra del Fuego</option>
                                <option value="Tucum√°n">Tucum√°n</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="1743418466">Localidad <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="1743418466" name="entry.1743418466" required type="text" />
                        </div>
                        <div class="form-group">
                            <label for="1005165410">C√≥digo Postal <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="1005165410" name="entry.1005165410" required type="text" inputmode="numeric" />
                        </div>
                         <div class="form-group">
                            <label for="951592426">Calle y N√∫mero <span style="color:var(--color-error)">*</span></label>
                            <input class="form-control" id="951592426" name="entry.951592426" placeholder="Ej: Av. Siempre Viva 742" required type="text"/>
                        </div>
                         <div class="form-group">
                            <label for="piso_depto">Piso / Depto / Casa (Opcional)</label>
                            <input class="form-control" id="piso_depto" name="entry.1945027933" placeholder="Ej: Piso 3 Depto B" type="text"/>
                            <p class="help-block">Aclaraciones adicionales para el cartero.</p>
                        </div>
                         {/* Hidden field for shipping type (Always Domicilio) */}
                         <div style="display:none;" class="form-group">
                            <label for="2315500325" class="hidden">Tipo de Env√≠o</label>
                            <select class="form-control" id="2315500325" name="entry.17650825"><option selected value="A DOMICILIO">A DOMICILIO</option></select>
                        </div>
                    </fieldset>

                     <div class="commitment-warning">
                          <span class="emoji">‚ö†Ô∏è</span> TU PEDIDO ES UN COMPROMISO DE COMPRA <span class="emoji">‚ö†Ô∏è</span>
                        <br>Por favor, revis√° que todos los datos sean correctos antes de continuar.
                    </div>

                     {/* Order Confirmation Summary */}
                     <div id="confirma-pedido" aria-live="polite">
                         <h3>Revis√° tu pedido:</h3>
                         <p class="summary-item"><span class="summary-label">Modelos/Talles:</span> <span id="help-modelostallesseleccionados" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">Nombre:</span> <span id="help-nombre" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">WhatsApp:</span> <span id="help-wapp" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">Email:</span> <span id="help-email" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">Direcci√≥n:</span> <span id="help-calleyaltura" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">Localidad:</span> <span id="help-localidad" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">Provincia:</span> <span id="help-provincia" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">CP:</span> <span id="help-cp" class="summary-value">-</span></p>
                         <p class="summary-item"><span class="summary-label">DNI:</span> <span id="help-dni" class="summary-value">-</span></p>

                         <fieldset>
                             <legend>Forma de Pago</legend>
                             <div class="form-group">
                                <label for="comoabona">¬øC√≥mo quer√©s abonar? <span style="color:var(--color-error)">*</span></label>
                                <select class="form-control" id="comoabona" name="comoabona" required>
                                    <option value="">-- Seleccion√° una opci√≥n --</option>
                                    <option value="tarjeta">Tarjeta de Cr√©dito (3 cuotas sin inter√©s) o D√©bito</option>
                                    <option value="mercadopago">Saldo en cuenta de MercadoPago</option>
                                    <option value="cbu">Transferencia Bancaria (10% Descuento Adicional)</option>
                                </select>
                                <p class="help-block">Ser√°s redirigido para completar el pago de forma segura.</p>
                            </div>
                         </fieldset>

                          <div id="preciototal">
                             Seleccion√° Modelos/Talles arriba para ver el total
                         </div>

                         <p class="help-block text-center" style="margin-top: 20px; font-size: 0.9em;">
                            <span class="emoji">üì¶</span> Despachamos en 15 d√≠as aprox. Recibir√°s el seguimiento por email.<br>
                            <span class="emoji">üîí</span> Pagar√°s de forma segura a trav√©s de MercadoPago o Transferencia.
                        </p>
                     </div>

                     {/* Hidden Fields for Form Submission */}
                     <textarea id="1209868979" name="entry.1209868979" class="hidden"></textarea> <!-- FBCLID -->
                     <input type="hidden" name="entry.978809450" id="link-mercadopago"> <!-- MP Link -->
                     <input name="fvv" type="hidden" value="1" />
                     <input name="fbzx" type="hidden" value="5661184097173102736" />
                     <input name="pageHistory" type="hidden" value="0" />

                     <button class="btn btn-primary" id="botoncomprar" type="submit">IR A PAGAR <span class="emoji">üí≥</span></button>
                </div>
            </form>
         </section>

    </main>

    {/* Elements outside main container for fixed positioning */}
    <div id="text" style="display: none;"> {/* Bottom Bar */}
        <div id="text-content"><b>PEDIDO:</b> <span>A√∫n no seleccionaste modelos</span><span id="preciototal2"></span></div>
        <a id="finalizarpedido" href="#restodelform" style="display: none;">FINALIZAR COMPRA</a>
    </div>

    <div id="whatsapp" style="display: none;"> {/* WhatsApp Button */}
        <a href="https://api.whatsapp.com/send?phone=5491127595502&text=Hola!%20Quiero%20consultar%20por%20el%20calzado%20Rosita%20Rococ√≥" id="linktowhatsapp" target="_blank" aria-label="Contactar por WhatsApp"><img alt="WhatsApp Icon" height="55" width="55" src="/whatsapp.png" loading="lazy"/></a>
    </div>

    <div id="notification-container"></div> {/* Notification Area */}

    <div class="loading-overlay" style="display: none;" aria-label="Procesando pago" role="alertdialog" aria-busy="true"> {/* Loading Overlay */}
          <div class="loading-content">
            <div class="loading-spinner"></div>
            <p class="loading-message">Estamos preparando tu pago seguro...<br>Espera un momento, no actualices la p√°gina.</p>
        </div>
    </div>

    {/* JavaScript Libraries */}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.3.0/jquery.form.min.js" integrity="sha512-YUkaLm+KJ5lQXDBdqBqk7EVhJAdxRnVdT2vtCzwPHSweCzyMgYV/tgGF4/dCyqtCC2eCphz0lRQgatGVdfR0ww==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js" integrity="sha512-57oZ/vW8ANMjR/KQ6Be9v/+/h6bq9/l3f0Oc7vn6qMqyhvPd1cvKBRWWpzu0QoneImqr2SkmO4MSqU+RpHom3Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>

    {/* Custom JavaScript */}
    <script>
    $(function() { // Equivalent to $(document).ready()

        // --- Global Variables & Constants ---
        const PRICE_ONE_PAIR = 70000;
        const PRICE_TWO_PAIRS = 110000;
        const DISCOUNT_TRANSFER = 0.10; // 10% discount
        const CURRENCY_FORMAT = new Intl.NumberFormat('es-AR', { style: 'currency', currency: 'ARS', minimumFractionDigits: 0 });
        const $restodelform = $("#restodelform");
        const $textBar = $("#text");
        const $textBarContent = $("#text-content");
        const $finalizarPedidoBtn = $("#finalizarpedido");
        const $selectedItemsInput = $("#1471599855");
        const $priceTotalDisplay = $("#preciototal");
        const $priceTotalDisplayBar = $("#preciototal2"); // In the bottom bar
        const $form = $('#bootstrapForm');
        const $submitButton = $('#botoncomprar');
        const $loadingOverlay = $('.loading-overlay');
        const $whatsappInput = $('#53830725');
        const $emailInput = $('#1465946249');
        const $dniInput = $('#541001873');
        const $paymentMethodSelect = $('#comoabona');
        const $regionBar = $("#region");
        const $whatsappButton = $('#whatsapp');
        const $fechahoy = $("#fechahoy");
        const $notificationContainer = $('#notification-container');
        // ** IMPORTANT: Add ALL model IDs here for JS logic to work **
        const ALL_MODEL_IDS = ['roma-negras', 'roma-suela', 'siena2025'];
        const MP_WEBHOOK_URL = "https://sswebhookss.odontolab.co/webhook/addaa0c8-96b1-4d63-b2c0-991d6be3de30";
        const WP_VALIDATION_URL = "https://sswebhookss.odontolab.co/webhook/02eb0643-1b9d-4866-87a7-f892d6a945ea";
        const SALES_DATA = [ // Sales Notification Data (Keep paths relative or absolute as needed)
            { name: 'Mar√≠a G.', city: 'CABA', order: 'Roma Negro', time: '20 min', img: 'roma-negras-1.jpg' },
            { name: 'Sof√≠a L.', city: 'Ramos Mej√≠a', order: 'Roma Suela', time: '1 hr', img: 'roma-suela-1a.jpg' },
            { name: 'Roc√≠o M.', city: 'C√≥rdoba', order: 'Siena Negro', time: '3 hs', img: 'siena2025-1.webp' },
            { name: 'Valeria P.', city: 'Rosario', order: 'Roma Negro x2', time: '4 hs', img: 'roma-negras-1a.jpg' },
        ];

        // --- State Variables ---
        let isWhatsAppValid = false;
        let isWhatsAppChecking = false;
        let wpValidationTimeout;
        let currentNotificationIndex = 0;
        let formTopOffset = $(document).height(); // Initial high value

        // --- Function Definitions ---

        function formatPrice(amount) {
            return CURRENCY_FORMAT.format(amount);
        }

        // Debounce function to limit rapid execution
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Typewriter effect for date
        function typeWriter(element, text, speed, callback) {
            let i = 0;
            element.html(''); // Clear previous text
            function type() {
                if (i < text.length) {
                    element.append(text.charAt(i));
                    i++;
                    setTimeout(type, speed);
                } else if (callback) {
                    callback();
                }
            }
            type();
        }

        // Show sticky top message (e.g., item added)
        function showStickyMessage(message, duration = 5000) {
             $('.avisoagregado-fixed').remove(); // Remove previous message
             $('<p class="avisoagregado-fixed"></p>')
                .html(message) // Use html to allow simple tags like strong, br
                .insertAfter(".site-header") // Insert below header
                .hide() // Start hidden
                .fadeIn(500) // Fade in
                .delay(duration)
                .fadeOut(1000, function() { $(this).remove(); }); // Fade out and remove
        }

        // Update order summary in form and bottom bar
        function updateOrderSummary() {
            const summaryTextRaw = $selectedItemsInput.val().trim().replace(/,\s*$/, ""); // Cleaned summary string
            const summaryParts = summaryTextRaw === "" ? [] : summaryTextRaw.split(', ');
            const itemCount = summaryParts.length;

            // Update summary text in the main form
            $("#help-modelostallesseleccionados").text(summaryTextRaw || '-');

            // Update bottom bar text
            let summaryTextForBar = 'A√∫n no seleccionaste modelos';
            if (itemCount > 0) {
                summaryTextForBar = summaryParts.join(' / '); // Use slash for conciseness
                 // Optionally shorten further if too long for mobile bar
                 if (itemCount > 1 && summaryTextForBar.length > 40) { // Example length check
                     summaryTextForBar = `${itemCount} pares seleccionados`;
                 }
            }
            $textBarContent.find('b').html(`PEDIDO (${itemCount} ${itemCount === 1 ? 'par' : 'pares'}):`);
            $textBarContent.find('span:not(#preciototal2)').html(summaryTextForBar);


            // Calculate total and update price displays
            let total = 0;
            let formPriceMessage = "";
            let canSubmit = false;
            const paymentMethod = $paymentMethodSelect.val();
            const isTransfer = paymentMethod === 'cbu';
            let finalAmount = 0; // Price considering discount

            if (itemCount === 1) {
                total = PRICE_ONE_PAIR;
                finalAmount = isTransfer ? total * (1 - DISCOUNT_TRANSFER) : total;
                formPriceMessage = `TOTAL: <span class='preciototalaobservar'>${formatPrice(finalAmount)}</span> x 1 par + <span class='shipping-free'>ENV√çO GRATIS</span><br><span class='add-more-info'>Si agreg√°s otro par, cada uno te queda a ${formatPrice(PRICE_TWO_PAIRS / 2)}.</span>`;
                canSubmit = true;
            } else if (itemCount === 2) {
                total = PRICE_TWO_PAIRS;
                finalAmount = isTransfer ? total * (1 - DISCOUNT_TRANSFER) : total;
                formPriceMessage = `TOTAL: <span class='preciototalaobservar'>${formatPrice(finalAmount)}</span> x 2 pares + <span class='shipping-free'>ENV√çO GRATIS</span><br><span class='add-more-info'>¬°Excelente! Ya ten√©s el mejor precio.</span>`;
                canSubmit = true;
            } else if (itemCount > 2) {
                const excess = itemCount - 2;
                formPriceMessage = `<span style='color: var(--color-error);'>‚õîÔ∏è Solo puedes pedir un m√°ximo de 2 pares.</span><br>Elimin√° ${excess} ${excess === 1 ? 'par' : 'pares'} para continuar.`;
                canSubmit = false;
            } else {
                formPriceMessage = "Seleccion√° modelos/talles arriba para ver el total.";
                canSubmit = false;
            }

            // Update price displays
            $priceTotalDisplay.html(formPriceMessage);
            $priceTotalDisplayBar.html(total > 0 ? `<span class='preciototalaobservar'>${formatPrice(finalAmount)}</span>` : ''); // Show price or nothing in bar

             // Disable submit button if validation fails or WhatsApp is invalid
            $submitButton.prop('disabled', !canSubmit || !isWhatsAppValid);

            // Toggle visibility of bottom bar, finalize button, and the main form section
            if (itemCount > 0) {
                if ($textBar.css('display') === 'none') { $textBar.css('display', 'flex').hide().fadeIn(300); } // Fade in bar
                $finalizarPedidoBtn.css('display', 'inline-block'); // Ensure button is block for layout
                 if ($restodelform.is(':hidden')) {
                     $restodelform.slideDown(400, function() {
                         formTopOffset = $restodelform.offset().top; // Update offset *after* animation
                     });
                 } else {
                      formTopOffset = $restodelform.offset().top; // Update if already visible
                 }
                 if ($whatsappButton.is(':hidden')) { setTimeout(() => { $whatsappButton.fadeIn(); }, 1500); } // Delayed WP button
            } else {
                 if ($textBar.css('display') !== 'none') { $textBar.fadeOut(300); } // Fade out bar
                 $finalizarPedidoBtn.css('display', 'none');
                 if ($restodelform.is(':visible')) { $restodelform.slideUp(400); }
            }
             handleScroll(); // Re-evaluate scroll state after updates
        }

        // Handle change in Talle dropdowns
        function handleTalleSelectionChange() {
            const $select = $(this);
            const selectedValue = $select.val();
            const previousValue = $select.data('pre') || "";

            // Update hidden input (#1471599855) which stores the selections
            let currentSummary = $selectedItemsInput.val();
            // Remove previous value if it existed
            if (previousValue) {
                // Use regex for safer replacement (handles special chars) and trailing comma/space
                currentSummary = currentSummary.replace(new RegExp(previousValue.replace(/[-\/\\^$*+?.()|[\]{}]/g, '\\$&') + ",\\s*"), "");
            }
            // Add new value if selected
            if (selectedValue) {
                currentSummary += selectedValue + ", ";
                // Show confirmation message only when adding a value
                 showStickyMessage("¬°Agregado! üëç Complet√° tus datos abajo ‚Üì");
            }
            $selectedItemsInput.val(currentSummary);
            $select.data('pre', selectedValue); // Store current value for the next change event

            updateOrderSummary(); // Update UI & Calculate Price

             // Track AddToCart event for Facebook Pixel
             if (typeof fbq === 'function' && selectedValue) {
                 fbq('track', 'AddToCart');
             }
        }

        // Handle change in Quantity radio buttons
        function handleQuantityChange() {
            const $radio = $(this);
            const selectedQuantity = parseInt($radio.val(), 10); // Get quantity as number
            const $card = $radio.closest('.product-card');
            const $sizeFieldsets = $card.find('.size-selection fieldset'); // Find fieldsets within the card

            $sizeFieldsets.each(function(index) {
                const $fieldset = $(this);
                // Show fieldsets up to the selected quantity, hide others
                if ((index + 1) <= selectedQuantity) {
                    if ($fieldset.is(':hidden')) $fieldset.slideDown('fast'); // Animate if hidden
                } else {
                    if ($fieldset.is(':visible')) {
                        // Slide up, then clear selection and trigger update *after* animation
                        $fieldset.slideUp('fast', function() {
                            $fieldset.find('select.talle').val('').trigger('change');
                        });
                    } else {
                        // If already hidden, just ensure value is cleared and trigger change
                        const $select = $fieldset.find('select.talle');
                        if($select.val() !== '') {
                             $select.val('').trigger('change'); // Trigger to update summary
                        }
                    }
                }
            });
        }

        // Update the summary fields within the form (#confirma-pedido)
        function updateFormSummaryFields() {
            $("#help-nombre").text($("#1460904554").val() || '-');
            $("#help-wapp").text($whatsappInput.val() || '-');
            $("#help-email").text($emailInput.val() || '-');
            $("#help-calleyaltura").text($("#951592426").val() || '-');
            $("#help-localidad").text($("#1743418466").val() || '-');
            $("#help-provincia").text($("#59648134 option:selected").text() || '-');
            $("#help-cp").text($("#1005165410").val() || '-');
            $("#help-dni").text($dniInput.val() || '-');
        }

        // Scroll smoothly to the top of the form section
        function scrollToForm() {
             if ($restodelform.is(':visible')) {
                 // Recalculate offset just before scrolling in case layout changed
                 formTopOffset = $restodelform.offset().top;
                 $('html, body').animate({
                     scrollTop: formTopOffset - 60 // Scroll slightly above form (adjust offset as needed)
                 }, 600); // Animation duration
             }
        }

        // Handle window scroll events (debounced)
        function handleScroll() {
             // Don't do anything if the form isn't visible
             if (!$restodelform.is(':visible')) {
                  if ($finalizarPedidoBtn.css('display') !== 'none') $finalizarPedidoBtn.fadeOut(200);
                 return;
             };

             // Ensure formTopOffset is current
              formTopOffset = $restodelform.offset().top;

            const itemsSelected = $selectedItemsInput.val().trim() !== "";
            const scrollPosition = $(window).scrollTop();

            // Hide button if scrolled past the form area, show if above and items selected
            if (scrollPosition > formTopOffset - 80 ) { // Hide if viewport top is near/past form top
                 if ($finalizarPedidoBtn.css('display') !== 'none') {
                     $finalizarPedidoBtn.fadeOut(200); // Fade out smoothly
                 }
            } else if (itemsSelected) { // Show only if items are selected and user is above the form
                 if ($finalizarPedidoBtn.css('display') === 'none') {
                     $finalizarPedidoBtn.fadeIn(200); // Fade in smoothly
                  }
            } else { // If no items selected, ensure it's hidden
                 if ($finalizarPedidoBtn.css('display') !== 'none') $finalizarPedidoBtn.fadeOut(200);
            }
        }

        // Handle form submission
        async function submitFormHandler(event) {
            event.preventDefault(); // Prevent default browser submission

            // --- Basic Spam Check (Honeypot) ---
            if ($('#website').val() !== '') {
                console.log("Honeypot triggered.");
                return false;
            }

            // --- Form Validation ---
            let formIsValid = true;
            // Check all required fields
            $form.find('[required]').each(function() {
                $(this).css('border-color', ''); // Reset border color
                if (!$(this).val() || ($(this).is('select') && $(this).val() === "")) {
                    formIsValid = false;
                    $(this).css('border-color', 'var(--color-error)'); // Highlight invalid field
                }
            });

            // Check item count (must be 1 or 2)
            const items = $selectedItemsInput.val().trim().split(', ');
            const itemCount = items[0] === "" ? 0 : items.length;
            if (itemCount === 0 || itemCount > 2) {
                formIsValid = false;
                 // Highlight the summary textarea if item count is wrong
                $selectedItemsInput.css('border-color', 'var(--color-error)');
            } else {
                $selectedItemsInput.css('border-color', ''); // Reset border if count is ok
            }


             // Check WhatsApp validity again before submitting
             if (!isWhatsAppValid) {
                 $whatsappInput.css('border-color', 'var(--color-error)');
                 formIsValid = false;
                 // Ensure error message is visible if not already
                 if (!getWhatsAppErrorElement().is(':visible') || !getWhatsAppErrorElement().hasClass('invalid')) {
                     showWhatsAppError("Verific√° tu n√∫mero de WhatsApp.", 'invalid');
                 }
             }

            // If form is not valid, show alert and stop submission
            if (!formIsValid) {
                alert('Por favor, complet√° todos los campos requeridos (*), asegurate de tener 1 o 2 pares seleccionados y que tu WhatsApp sea v√°lido.');
                // Scroll to the first invalid field for user convenience
                 const firstInvalid = $form.find('[required]').filter(function() {
                    return !$(this).val() || ($(this).is('select') && $(this).val() === "") || $(this).css('border-color').includes('rgb(192, 57, 43)'); // Check for empty or red border
                 }).first();

                 if (firstInvalid.length) {
                     $('html, body').animate({ scrollTop: firstInvalid.offset().top - 80 }, 300);
                     firstInvalid.focus(); // Set focus to the invalid field
                 }
                return;
            }

            // --- Form is Valid - Proceed with Submission ---
            $submitButton.text('Procesando...').prop('disabled', true);
            $loadingOverlay.css('display', 'flex'); // Show loading indicator

            const formAction = $form.attr('action'); // Google Forms URL
            const formData = new FormData(this);
            const paymentMethod = $paymentMethodSelect.val();
            const buyerName = $('#1460904554').val();

            // Get final amount from price display
             const amountText = $priceTotalDisplay.find(".preciototalaobservar").text();
            let amount = 0;
             try {
                 // Robust amount parsing
                 const cleanedAmount = amountText.replace(/[$.]/g, '').replace(',', '.');
                 amount = parseFloat(cleanedAmount);
                 if (isNaN(amount) || amount <= 0) throw new Error("Invalid amount parsed");
             } catch (e) {
                 console.error("Error parsing amount:", amountText, e);
                 alert("Error al procesar el monto del pedido. Intente nuevamente o contactanos.");
                 $loadingOverlay.css('display', 'none');
                 $submitButton.text('IR A PAGAR').prop('disabled', !canSubmit || !isWhatsAppValid); // Re-enable based on state
                 return;
             }

            // --- Submit Logic ---
            try {
                 // 1. Send data to Google Forms (using no-cors as response isn't needed)
                 await fetch(formAction, {
                     method: 'POST',
                     mode: 'no-cors', // Important for Google Forms
                     body: new URLSearchParams(formData) // Convert FormData for URL encoding
                 });
                 console.log("Data potentially sent to Google Forms (no-cors mode).");

                 // 2. Track Facebook InitiateCheckout event
                 if (typeof fbq === 'function') {
                    fbq('track', 'InitiateCheckout', { value: amount, currency: 'ARS', num_items: itemCount });
                 }

                 // 3. Redirect based on payment method
                 if (paymentMethod === "cbu") {
                     // Determine CBU page based on item count
                     const redirectUrl = itemCount === 2 ?
                         'https://rositarococo.com/transferenciacbu-2pares.html' :
                         'https://rositarococo.com/transferenciacbu-1par.html';
                     // Small delay before redirecting
                     setTimeout(() => { window.location.href = redirectUrl; }, 500);

                 } else if (paymentMethod === "tarjeta" || paymentMethod === "mercadopago") {
                     // Fetch MercadoPago link from your webhook
                    const response = await fetch(MP_WEBHOOK_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ comprador: buyerName, monto: amount })
                    });
                    if (!response.ok) throw new Error(`MercadoPago API Error: ${response.status} ${await response.text()}`); // Include response text on error
                    const jsonData = await response.json();
                    const mercadoPagoUrl = jsonData.linkpersonalizadomp; // Get the URL from the JSON response
                    if (!mercadoPagoUrl) throw new Error('Link de MercadoPago no recibido del webhook.');

                    $('#link-mercadopago').val(mercadoPagoUrl); // Update hidden field (optional, but good practice)
                    // Redirect to MercadoPago after a slightly longer delay
                    setTimeout(() => { window.location.href = mercadoPagoUrl; }, 1500);
                 }

                 // Note: Loading overlay stays visible until redirection happens

            } catch (error) {
                // --- Handle Errors ---
                console.error("Submit Error:", error);
                $loadingOverlay.css('display', 'none'); // Hide loading indicator on error
                $submitButton.text('IR A PAGAR').prop('disabled', !canSubmit || !isWhatsAppValid); // Re-enable button based on state
                alert('Hubo un problema al procesar tu pedido. Por favor, intent√° nuevamente o contactanos por WhatsApp si el problema persiste.');
            }
        }

        // --- WhatsApp Validation Functions ---
         function getWhatsAppErrorElement() { return $whatsappInput.parent().find(".error-message"); }
         function showWhatsAppError(message, type = 'invalid') { getWhatsAppErrorElement().text(message).removeClass('valid invalid verifying api-error').addClass(type).slideDown('fast'); }
         function hideWhatsAppError() { getWhatsAppErrorElement().slideUp('fast'); }

         // Enable/disable form fields that depend on a valid WhatsApp number
         function setDependentFieldsDisabled(disabled) {
             const dependentIds = ["59648134", "1743418466", "1005165410", "951592426", "541001873", "piso_depto", "comoabona", "botoncomprar"];
             dependentIds.forEach(id => {
                 const $el = $(`#${id}`);
                 if ($el.length) {
                     $el.prop('disabled', disabled);
                      // Add/remove a visual cue if desired
                      // $el.toggleClass('disabled-field', disabled);
                 }
             });
              // Explicitly re-evaluate submit button state AFTER enabling/disabling fields
              updateOrderSummary();
         }

         // Async function to validate WhatsApp number via webhook
         async function validateWhatsApp() {
             if (isWhatsAppChecking) return; // Prevent simultaneous checks
             const number = $whatsappInput.val().trim();

             // Basic client-side check (length)
             if (!number || number.length < 9 || number.length > 11) { // Adjust length check as needed for AR numbers
                 hideWhatsAppError();
                 setDependentFieldsDisabled(true); // Disable dependent fields
                 isWhatsAppValid = false;
                 updateOrderSummary(); // Update submit button state
                 return; // Stop if basic check fails
             }

             isWhatsAppChecking = true;
             showWhatsAppError("Verificando WhatsApp...", 'verifying');
             setDependentFieldsDisabled(true); // Disable while checking

             // Format number (remove non-digits, add country code if missing)
             let formattedNumber = number.replace(/\D/g, "");
              // Simple check: if 10 digits and doesn't start with 9, assume mobile without 9, add 549
              if (formattedNumber.length === 10 && !formattedNumber.startsWith('9')) {
                   formattedNumber = '549' + formattedNumber;
              }
              // If 11 digits and starts with 9, assume 549 is missing
              else if (formattedNumber.length === 11 && formattedNumber.startsWith('9')) {
                   formattedNumber = '54' + formattedNumber;
              }
              // If 11 digits starting 11/15/etc (old format), try stripping first two? - Complex, stick to simpler rules or adjust API side
              else if (!formattedNumber.startsWith('549')) {
                  // Fallback or specific logic needed here if other formats are common
                   // For now, assume 549 if length is appropriate
                  if (formattedNumber.length >= 10) formattedNumber = '549' + formattedNumber.substring(formattedNumber.length - 10);
              }


             try {
                 const response = await fetch(WP_VALIDATION_URL, {
                     method: 'POST',
                     headers: { 'Content-Type': 'application/json' },
                     body: JSON.stringify({ whatsapp_check: formattedNumber }) // Send formatted number
                 });

                 if (!response.ok) { // Handle non-2xx responses
                      throw new Error(`API Error: ${response.status} ${await response.text()}`);
                 }

                 const data = await response.json();
                 isWhatsAppValid = data.exists === true; // Check the 'exists' property from API response

                 if (isWhatsAppValid) {
                     showWhatsAppError("WhatsApp v√°lido.", 'valid');
                     setDependentFieldsDisabled(false); // Enable dependent fields
                 } else {
                     showWhatsAppError("WhatsApp no v√°lido o no encontrado. Verific√° el n√∫mero.", 'invalid');
                     setDependentFieldsDisabled(true); // Keep fields disabled
                 }

             } catch (error) {
                 console.error("WP validation error:", error);
                 showWhatsAppError("Error al verificar WhatsApp. Intent√° de nuevo o contactanos.", 'api-error');
                 setDependentFieldsDisabled(true); // Keep fields disabled on error
                 isWhatsAppValid = false; // Assume invalid on error
             } finally {
                 isWhatsAppChecking = false; // Allow new checks
                 updateOrderSummary(); // Update submit button state based on validation result
             }
         }

        // --- Sales Notifications ---
        function showSalesNotification() {
            if (currentNotificationIndex >= SALES_DATA.length) { currentNotificationIndex = 0; } // Loop through data
            const data = SALES_DATA[currentNotificationIndex];

            // Create notification HTML dynamically
            const $notification = $(`
                <div class="notification">
                    <img src="${data.img}" alt="${data.order}" loading="lazy">
                    <div class="order-info">
                        <div class="customer-info">
                            <h3>‚úÖ ${data.name}</h3>
                            <span class="city">üìç ${data.city}</span>
                        </div>
                        <p class="order">Compr√≥ ${data.order}</p>
                        <p class="time-since-purchase">hace ${data.time}</p>
                    </div>
                    <button class="close" aria-label="Cerrar notificaci√≥n">X</button>
                </div>
            `);

            // Add close button functionality
            $notification.find('.close').on('click', function() {
                $(this).closest('.notification').fadeOut(300, function() { $(this).remove(); });
            });

            // Remove any existing notification before adding the new one
            $notificationContainer.find('.notification').fadeOut(300, function() { $(this).remove(); });
            // Append the new notification and make it visible
            $notificationContainer.append($notification);

            // Auto-hide the notification after a delay
            setTimeout(() => {
                 $notification.fadeOut(500, function() { $(this).remove(); });
             }, 7000); // Notification display duration

            currentNotificationIndex++; // Move to the next notification data
        }

        // --- Initialization Code ---

        // Initialize Slick Carousels
        $('.model-carousel').slick({
            dots: true,
            infinite: true,
            speed: 400,
            fade: true,
            cssEase: 'linear',
            lazyLoad: 'ondemand',
            adaptiveHeight: false, // Set true ONLY if image heights vary AND you use height:auto in CSS
            slidesToShow: 1,
            arrows: true,
            accessibility: true,
            focusOnSelect: false // Don't focus carousel on dot/arrow click
        });
        $('.testimonials-carousel').slick({
            dots: true,
            infinite: true,
            speed: 500,
            arrows: false, // Hide arrows for testimonials
            autoplay: true,
            autoplaySpeed: 3500,
            slidesToShow: 1,
            adaptiveHeight: true // Good for varying comment image heights
        });

        // Setup Product Quantity/Size Logic for all defined models
        ALL_MODEL_IDS.forEach(id => {
            const $card = $(`.product-card[id$="-${id}"]`); // Find card by ID ending
            // Attach quantity change handler
             $card.find(`input[name="hwA-qty-${id}"]`).on('change', handleQuantityChange);
            // Trigger initial state based on checked radio (usually '1')
             $card.find(`input[name="hwA-qty-${id}"]:checked`).trigger('change');
        });
        // Attach talle change handler to all talle selects
        $("#todoslosmodelos select.talle").on('change', handleTalleSelectionChange);

        // Update form summary fields on input/change
        $("#1460904554, #1465946249, #53830725, #951592426, #1743418466, #59648134, #1005165410, #541001873, #piso_depto")
            .on('keyup change input', updateFormSummaryFields);
        updateFormSummaryFields(); // Initial population of summary

        // Input Formatting/Cleaning
        $emailInput.on('input keyup', function() { $(this).val($(this).val().trim().toLowerCase()); });
        $dniInput.on('input keyup', function() { $(this).val($(this).val().replace(/[^\d]/g, '')); });
        $whatsappInput.on('input keyup', function() { $(this).val($(this).val().replace(/[^\d.-]/g, '')); }); // Allow digits, dot, hyphen temporarily

        // Update summary when payment method changes (for discount)
        $paymentMethodSelect.on('change', updateOrderSummary);

        // Attach form submission handler
        $form.on('submit', submitFormHandler);

        // WhatsApp Validation Setup
        const debouncedWPValidation = debounce(validateWhatsApp, 600); // Debounce API call
         // When user types, clear errors, mark as invalid, disable fields
        $whatsappInput.on('input', () => {
             hideWhatsAppError();
             isWhatsAppValid = false;
             setDependentFieldsDisabled(true);
             clearTimeout(wpValidationTimeout); // Clear any pending validation
             updateOrderSummary(); // Reflect disabled state in button
         });
         // When user leaves the field (blur), trigger validation
         $whatsappInput.on('blur', debouncedWPValidation);
         // Start with dependent fields disabled until WP is validated
         setDependentFieldsDisabled(true);

        // Display Current Date with Typewriter Effect
        const d = new Date();
        const strDate = d.getDate() + "/" + (d.getMonth() + 1) + "/" + d.getFullYear();
        const dateText = 'Ofertas v√°lidas HOY ' + strDate;
        $fechahoy.show();
        typeWriter($fechahoy, dateText, 50); // 50ms typing speed

        // Show Top Promo Bar
        $regionBar.html("<span class='emoji'>üöö</span> Env√≠o GRATIS a TODO el pa√≠s ¬°√öltimos d√≠as!").slideDown();

        // Email Autocomplete (using jQuery UI)
        const acList = ['gmail.com','hotmail.com','hotmail.com.ar','hotmail.es','yahoo.com.ar','yahoo.com','live.com.ar','live.com','outlook.com'];
        if ($.ui && $.ui.autocomplete) { // Check if jQuery UI autocomplete is loaded
            $emailInput.autocomplete({
                source: function(request, response) {
                    const term = request.term;
                    const atIndex = term.lastIndexOf('@');
                    if (atIndex !== -1) {
                        const namePart = term.substring(0, atIndex);
                        const domainPart = term.substring(atIndex + 1);
                         // Filter domains based on input and map back to full email suggestion
                         response($.ui.autocomplete.filter(acList, domainPart).map(d => namePart + "@" + d));
                    }
                 },
                 minLength: 1, // Start suggesting after 1 character after '@'
                 select: function(event, ui) {
                     this.value = ui.item.value; // Set input value on selection
                     updateFormSummaryFields(); // Update summary if needed
                     return false; // Prevent default autocomplete action
                 }
            });
        } else {
            console.warn("jQuery UI Autocomplete not loaded.");
        }

        // Store FBCLID if present in URL
        try {
            const urlParams = new URLSearchParams(window.location.search);
            const fbclid = urlParams.get('fbclid');
            if (fbclid) {
                // Store the full URL including fbclid in the hidden field
                $("#1209868979").val(window.location.href);
                console.log("FBCLID found and stored.");
            }
        } catch (e) { console.warn("Error processing URL parameters for FBCLID:", e); }


        // Scroll Button Listeners
        $finalizarPedidoBtn.on('click', (e) => { e.preventDefault(); scrollToForm(); });
        // Debounce scroll/resize handler for performance
        $(window).on('scroll resize', debounce(handleScroll, 150)).trigger('scroll');


        // Start Sales Notifications after a delay
        setTimeout(() => {
            showSalesNotification(); // Show first one
            setInterval(showSalesNotification, 10000); // Show subsequent ones every 10s
        }, 9000); // Initial delay before first notification


        // Final initial UI state check
        updateOrderSummary();

    }); // End document ready
    </script>

</body>
</html>